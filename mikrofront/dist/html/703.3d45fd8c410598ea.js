"use strict";(self.webpackChunkmikrowizard=self.webpackChunkmikrowizard||[]).push([[703],{6703:(x,_,m)=>{m.r(_),m.d(_,{PermissionsModule:()=>S});var p=m(177),d=m(9417),r=m(8921),g=m(4662),f=m(7062),u=m(7390),h=m(7630),e=m(4438),b=m(9492),k=m(1170);const F=()=>["api","ftp","password","read","romon","sniff","telnet","tikapp","winbox"],C=()=>["dude","local","policy","reboot","rest-api","sensitive","ssh","test","web","write"];function T(n,a){1&n&&e.EFF(0),2&n&&e.SpI(" \xa0 ",a.item.name," ")}function j(n,a){if(1&n&&(e.j41(0,"c-badge",32),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.key)}}function M(n,a){if(1&n&&(e.qex(0),e.DNE(1,j,2,1,"c-badge",31),e.bVm()),2&n){const t=a.$implicit;e.R7$(),e.Y8G("ngIf",t.value)}}function E(n,a){if(1&n&&(e.j41(0,"div",30),e.DNE(1,M,2,1,"ng-container",25),e.nI1(2,"keyvalue"),e.k0s()),2&n){const t=a.item;e.R7$(),e.Y8G("ngForOf",e.bMT(2,1,t.perms))}}function R(n,a){if(1&n){const t=e.RV6();e.j41(0,"button",33),e.bIt("click",function(){const i=e.eBV(t).item,s=e.XpG();return e.Njj(s.editAddTask(i,"edit"))}),e.nrm(1,"i",34),e.k0s(),e.j41(2,"button",35),e.bIt("click",function(){const i=e.eBV(t).item,s=e.XpG();return e.Njj(s.confirm_delete(i))}),e.nrm(3,"i",36),e.k0s()}}function P(n,a){if(1&n&&(e.j41(0,"h5",23),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.SpI("Editing Permission ",t.SelectedPerm.name,"")}}function v(n,a){1&n&&(e.j41(0,"h5",23),e.EFF(1,"Adding new Permission Rule"),e.k0s())}function G(n,a){if(1&n){const t=e.RV6();e.j41(0,"c-form-check",37)(1,"input",38),e.mxI("ngModelChange",function(i){const s=e.eBV(t).$implicit,c=e.XpG();return e.DH7(c.perms[s],i)||(c.perms[s]=i),e.Njj(i)}),e.k0s(),e.j41(2,"label",39),e.EFF(3),e.k0s()()}if(2&n){const t=a.$implicit,o=e.XpG();e.Y8G("switch",!0),e.R7$(),e.R50("ngModel",o.perms[t]),e.R7$(2),e.JRh(t)}}function I(n,a){if(1&n){const t=e.RV6();e.j41(0,"c-form-check",37)(1,"input",38),e.mxI("ngModelChange",function(i){const s=e.eBV(t).$implicit,c=e.XpG();return e.DH7(c.perms[s],i)||(c.perms[s]=i),e.Njj(i)}),e.k0s(),e.j41(2,"label",39),e.EFF(3),e.k0s()()}if(2&n){const t=a.$implicit,o=e.XpG();e.Y8G("switch",!0),e.R7$(),e.R50("ngModel",o.perms[t]),e.R7$(2),e.JRh(t)}}function w(n,a){if(1&n&&(e.j41(0,"c-badge",41),e.EFF(1),e.k0s()),2&n){const t=a.$implicit,o=e.XpG(2);e.R7$(),e.JRh(o.get_member_by_id(t).name)}}function V(n,a){if(1&n&&(e.qex(0),e.DNE(1,w,2,1,"c-badge",40),e.bVm()),2&n){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.splitids(t.SelectedPermItems))}}function $(n,a){if(1&n){const t=e.RV6();e.j41(0,"button",6),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.submit("add"))}),e.EFF(1,"Add"),e.k0s()}}function y(n,a){if(1&n){const t=e.RV6();e.j41(0,"button",6),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.submit("edit"))}),e.EFF(1,"save"),e.k0s()}}function D(n,a){if(1&n&&(e.j41(0,"c-badge",32),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.key)}}function N(n,a){if(1&n&&(e.qex(0),e.DNE(1,D,2,1,"c-badge",31),e.bVm()),2&n){const t=a.$implicit;e.R7$(),e.Y8G("ngIf",t.value)}}const Y=[{path:"",component:(()=>{class n{constructor(t,o,i){this.data_provider=t,this.router=o,this.login_checker=i,this.source=[],this.columns=[],this.loading=!0,this.rows=[],this.SelectedPerm={},this.SelectedPermItems="",this.EditTaskModalVisible=!1,this.DeleteConfirmModalVisible=!1,this.Members="",this.SelectedMembers=[],this.action="add",this.permid=0,this.permname="",this.perms={api:!1,ftp:!1,password:!1,read:!1,romon:!1,sniff:!1,telnet:!1,tikapp:!1,winbox:!1,dude:!1,local:!1,policy:!1,reboot:!1,"rest-api":!1,sensitive:!1,ssh:!1,test:!1,web:!1,write:!1},this.toasterForm={autohide:!0,delay:3e3,position:"fixed",fade:!0,closeButton:!0},this.sorting={enabled:!0,multiSorting:!0},this.paging={enabled:!0,page:1,pageSize:10,pageSizes:[5,10,25,50],display:u.sE.ADVANCED},this.columnMenu={enabled:!0,sort:!0,columnsManager:!0};var s=this;this.login_checker.isLoggedIn()||setTimeout(function(){s.router.navigate(["login"])},100),this.data_provider.getSessionInfo().then(l=>{s.uid=l.uid,s.uname=l.name,"admin"!=l.role&&setTimeout(function(){s.router.navigate(["/user/dashboard"])},100)})}show_toast(t,o,i){const{...s}={...this.toasterForm,color:i,title:t,body:o};this.viewChildren.first.addToast(h.y,s,{}).instance.closeButton=s.closeButton}ngOnInit(){this.initGridTable()}submit(t){var o=this;"add"==t?this.data_provider.create_perm(o.permname,o.perms).then(i=>{"failed"!=i.status?(o.initGridTable(),this.EditTaskModalVisible=!1):o.show_toast("Error",i.err,"danger")}):this.data_provider.edit_perm(o.permid,o.permname,o.perms).then(i=>{"failed"!=i.status?(o.initGridTable(),this.EditTaskModalVisible=!1):o.show_toast("Error",i.err,"danger")})}editAddTask(t,o){if("showadd"==o)return this.permname=t.name,this.perms={api:!1,ftp:!1,password:!1,read:!1,romon:!1,sniff:!1,telnet:!1,tikapp:!1,winbox:!1,dude:!1,local:!1,policy:!1,reboot:!1,"rest-api":!1,sensitive:!1,ssh:!1,test:!1,web:!1,write:!1},this.permid=0,this.action="add",void(this.EditTaskModalVisible=!0);this.action="edit",this.permname=t.name,this.perms=t.perms,this.permid=t.id,this.EditTaskModalVisible=!0}splitids(t=""){return t.split(",")}get_member_by_id(t){return this.Members.find(o=>o.id==t)}confirm_delete(t="",o=!1){if(o){var i=this;this.data_provider.delete_perm(i.SelectedPerm.id).then(s=>{if("error"in s&&s.error.indexOf("Unauthorized"))i.show_toast("Error","You are not authorized to perform this action","danger");else{if("failed"==s.status)return void i.show_toast("Error",s.err,"danger");i.initGridTable(),i.DeleteConfirmModalVisible=!1}})}else this.SelectedPerm={...t},this.DeleteConfirmModalVisible=!0}logger(t){console.dir(t)}initGridTable(){var t=this;this.data_provider.get_perms(1,10,"").then(c=>{t.source=c.map(l=>l),t.loading=!1})}static#e=this.\u0275fac=function(o){return new(o||n)(e.rXU(b.C),e.rXU(f.Ix),e.rXU(k.T))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["ng-component"]],viewQuery:function(o,i){if(1&o&&e.GBs(r.E0T,5),2&o){let s;e.mGM(s=e.lsd())&&(i.viewChildren=s)}},decls:80,vars:31,consts:[["EditTaskModal",""],["DeleteConfirmModal",""],["xs",""],[1,"mb-4"],["xs","",3,"lg"],["xs","",2,"text-align","right",3,"lg"],["cButton","","color","primary",3,"click"],[1,"fa-solid","fa-plus"],[3,"rowHeight","autoResizeWidth","source","columnMenu","sorting","paging"],["header","Name","field","name"],["width","auto","header","Perms","field","perms"],["header","Actions","width","120","field","action"],["backdrop","static","size","lg","id","EditTaskModal",3,"visibleChange","visible"],["cModalTitle","",4,"ngIf"],["cButtonClose","",3,"cModalToggle"],[1,"mb-3",3,"cFormFloating"],["cFormControl","","id","floatingInput","placeholder","permname",3,"ngModelChange","ngModel"],["cLabel","","for","floatingInput"],[3,"switch",4,"ngFor","ngForOf"],[4,"ngIf"],["cButton","","color","primary",3,"click",4,"ngIf"],["cButton","","color","secondary",3,"cModalToggle"],["backdrop","static","id","DeleteConfirmModal",3,"visibleChange","visible"],["cModalTitle",""],[2,"width","100%"],[4,"ngFor","ngForOf"],[2,"padding","0!important"],["cButton","","color","danger",3,"click"],["cButton","","color","info",3,"cModalToggle"],["position","fixed","placement","top-end"],[2,"text-wrap","initial"],["class","m-1","color","success",4,"ngIf"],["color","success",1,"m-1"],["cButton","","color","warning","size","sm",1,"mx-1",3,"click"],[1,"fa-regular","fa-pen-to-square"],["cButton","","color","danger","size","sm",3,"click"],[1,"fa-regular","fa-trash-can"],[3,"switch"],["cFormCheckInput","","type","checkbox",3,"ngModelChange","ngModel"],["cFormCheckLabel",""],["class","mx-1","color","dark",4,"ngFor","ngForOf"],["color","dark",1,"mx-1"]],template:function(o,i){if(1&o){const s=e.RV6();e.j41(0,"c-row")(1,"c-col",2)(2,"c-card",3)(3,"c-card-header")(4,"c-row")(5,"c-col",4),e.EFF(6," Permissions "),e.k0s(),e.j41(7,"c-col",5)(8,"button",6),e.bIt("click",function(){return e.eBV(s),e.Njj(i.editAddTask({},"showadd"))}),e.nrm(9,"i",7),e.k0s()()()(),e.j41(10,"c-card-body")(11,"gui-grid",8)(12,"gui-grid-column",9),e.DNE(13,T,1,1,"ng-template"),e.k0s(),e.j41(14,"gui-grid-column",10),e.DNE(15,E,3,3,"ng-template"),e.k0s(),e.j41(16,"gui-grid-column",11),e.DNE(17,R,4,0,"ng-template"),e.k0s()()()()()(),e.j41(18,"c-modal-header")(19,"c-modal",12,0),e.mxI("visibleChange",function(l){return e.eBV(s),e.DH7(i.EditTaskModalVisible,l)||(i.EditTaskModalVisible=l),e.Njj(l)}),e.j41(21,"c-modal-header"),e.DNE(22,P,2,1,"h5",13)(23,v,2,0,"h5",13),e.nrm(24,"button",14),e.k0s(),e.j41(25,"c-modal-body")(26,"div",15)(27,"input",16),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(i.permname,l)||(i.permname=l),e.Njj(l)}),e.k0s(),e.j41(28,"label",17),e.EFF(29,"Name"),e.k0s()(),e.j41(30,"c-row")(31,"c-col"),e.DNE(32,G,4,3,"c-form-check",18),e.k0s(),e.j41(33,"c-col"),e.DNE(34,I,4,3,"c-form-check",18),e.k0s()(),e.DNE(35,V,2,1,"ng-container",19),e.k0s(),e.j41(36,"c-modal-footer"),e.DNE(37,$,2,0,"button",20)(38,y,2,0,"button",20),e.j41(39,"button",21),e.EFF(40," Close "),e.k0s()()(),e.j41(41,"c-modal",22,1),e.mxI("visibleChange",function(l){return e.eBV(s),e.DH7(i.DeleteConfirmModalVisible,l)||(i.DeleteConfirmModalVisible=l),e.Njj(l)}),e.j41(43,"c-modal-header")(44,"h5",23),e.EFF(45),e.k0s(),e.nrm(46,"button",14),e.k0s(),e.j41(47,"c-modal-body"),e.EFF(48," Are you sure that You want to delete following Permission? "),e.nrm(49,"br")(50,"br"),e.j41(51,"table",24)(52,"tr")(53,"td")(54,"b"),e.EFF(55,"Permission name : "),e.k0s(),e.EFF(56),e.k0s()(),e.j41(57,"tr")(58,"td"),e.DNE(59,N,2,1,"ng-container",25),e.nI1(60,"keyvalue"),e.k0s()(),e.j41(61,"tr")(62,"td")(63,"p")(64,"code",26)(65,"b"),e.EFF(66,"Warning:"),e.k0s(),e.EFF(67," ALL Given "),e.j41(68,"b"),e.EFF(69,"device access"),e.k0s(),e.EFF(70," related to this permision in Users Section "),e.j41(71,"b"),e.EFF(72,"will be deleted"),e.k0s(),e.EFF(73," for each user"),e.k0s()()()()()(),e.j41(74,"c-modal-footer")(75,"button",27),e.bIt("click",function(){return e.eBV(s),e.Njj(i.confirm_delete("",!0))}),e.EFF(76," Yes,Delete! "),e.k0s(),e.j41(77,"button",28),e.EFF(78," Close "),e.k0s()()(),e.nrm(79,"c-toaster",29),e.k0s()}if(2&o){const s=e.sdS(20),c=e.sdS(42);e.R7$(5),e.Y8G("lg",10),e.R7$(2),e.Y8G("lg",2),e.R7$(4),e.Y8G("rowHeight",82)("autoResizeWidth",!0)("source",i.source)("columnMenu",i.columnMenu)("sorting",i.sorting)("autoResizeWidth",!0)("paging",i.paging),e.R7$(8),e.R50("visible",i.EditTaskModalVisible),e.R7$(3),e.Y8G("ngIf","edit"==i.action),e.R7$(),e.Y8G("ngIf","add"==i.action),e.R7$(),e.Y8G("cModalToggle",s.id),e.R7$(2),e.Y8G("cFormFloating",!0),e.R7$(),e.R50("ngModel",i.permname),e.R7$(5),e.Y8G("ngForOf",e.lJ4(29,F)),e.R7$(2),e.Y8G("ngForOf",e.lJ4(30,C)),e.R7$(),e.Y8G("ngIf",i.SelectedMembers.length>0&&i.EditTaskModalVisible),e.R7$(2),e.Y8G("ngIf","add"==i.action),e.R7$(),e.Y8G("ngIf","edit"==i.action),e.R7$(),e.Y8G("cModalToggle",s.id),e.R7$(2),e.R50("visible",i.DeleteConfirmModalVisible),e.R7$(4),e.SpI("Confirm delete ",i.SelectedPerm.name,""),e.R7$(),e.Y8G("cModalToggle",c.id),e.R7$(10),e.SpI("",i.SelectedPerm.name," "),e.R7$(3),e.Y8G("ngForOf",e.bMT(60,27,i.SelectedPerm.perms)),e.R7$(18),e.Y8G("cModalToggle",c.id)}},dependencies:[r.iby,r.qHy,r.lMi,p.Sq,p.bT,r.gLf,r.oMR,r.E0T,r.akk,r.cy2,r.iQ3,r.l_X,r.e$m,r.YJZ,r._fv,r.UjT,u.V1,u.fz,r.Jyz,r.zfW,r.s$3,r.epl,r.L$K,r.VtU,d.me,d.Zm,d.BC,d.vS,r.nSt,p.lG],encapsulation:2})}return n})(),data:{title:$localize`Permissions`}}];let B=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275mod=e.$C({type:n});static#i=this.\u0275inj=e.G2t({imports:[f.iI.forChild(Y),f.iI]})}return n})(),S=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275mod=e.$C({type:n});static#i=this.\u0275inj=e.G2t({imports:[B,r.Dw2,r.Ied,g.op,r.jr_,p.MD,r.pc9,r.MBE,r.tHK,r.tmq,r.ayw,u.uM,r.Q_q,d.YN,r.EJq]})}return n})()}}]);