"use strict";(self.webpackChunkmikrowizard=self.webpackChunkmikrowizard||[]).push([[325],{8325:(A,g,c)=>{c.r(g),c.d(g,{DevicesGroupModule:()=>$});var _=c(177),l=c(8921),p=c(7062),m=c(7390),e=c(4438),b=c(9492),f=c(1170),d=c(9417);function h(o,s){1&o&&e.EFF(0),2&o&&e.SpI(" ",s.item.name," ")}function G(o,s){1&o&&e.eu8(0)}function M(o,s){1&o&&(e.j41(0,"c-badge",38),e.EFF(1,"All Devices"),e.k0s())}function v(o,s){1&o&&(e.j41(0,"c-badge",38),e.EFF(1,"0 Members"),e.k0s())}function C(o,s){if(1&o&&(e.j41(0,"c-badge",38),e.EFF(1),e.k0s()),2&o){const t=e.XpG(2).item.array_agg;e.R7$(),e.SpI("",t.length," Members")}}function j(o,s){if(1&o&&e.DNE(0,v,2,0,"c-badge",39)(1,C,2,1,"c-badge",39),2&o){const t=e.XpG(),n=t.item.array_agg;e.Y8G("ngIf",null==n[0]&&1!=t.item.id),e.R7$(),e.Y8G("ngIf",null!=n[0])}}function k(o,s){if(1&o&&e.DNE(0,G,1,0,"ng-container",37)(1,M,2,0,"ng-template",null,3,e.C5r)(3,j,2,2,"ng-template",null,4,e.C5r),2&o){const t=s.item,n=e.sdS(2),i=e.sdS(4);e.Y8G("ngIf",1==t.id)("ngIfThen",n)("ngIfElse",i)}}function D(o,s){1&o&&e.EFF(0),2&o&&e.SpI(" ",s.item.created," ")}function w(o,s){if(1&o){const t=e.RV6();e.j41(0,"button",40),e.bIt("click",function(){const i=e.eBV(t).item,r=e.XpG();return e.Njj(r.editAddGroup(i,"showedit"))}),e.nrm(1,"i",41),e.k0s(),e.j41(2,"button",42),e.bIt("click",function(){const i=e.eBV(t).item,r=e.XpG();return e.Njj(r.show_members(i.id))}),e.nrm(3,"i",43),e.k0s(),e.j41(4,"button",44),e.bIt("click",function(){const i=e.eBV(t).item,r=e.XpG();return e.Njj(r.show_delete_group(i))}),e.nrm(5,"i",45),e.k0s()}if(2&o){const t=s.item.id;e.Y8G("disabled",1==t),e.R7$(2),e.Y8G("disabled",1==t),e.R7$(2),e.Y8G("disabled",1==t)}}function N(o,s){1&o&&e.EFF(0),2&o&&e.SpI(" \xa0 ",s.item.name," ")}function R(o,s){1&o&&e.EFF(0),2&o&&e.SpI(" ",s.item.ip," ")}function F(o,s){if(1&o){const t=e.RV6();e.j41(0,"button",46),e.bIt("click",function(){const i=e.eBV(t).item,r=e.XpG();return e.Njj(r.remove_from_group(i.id))}),e.nrm(1,"i",45),e.k0s()}}function E(o,s){if(1&o&&(e.j41(0,"button",47),e.nrm(1,"i",45),e.EFF(2),e.k0s()),2&o){const t=e.XpG();e.R7$(2),e.SpI("Delete ",t.MemberRows.length," Selected")}}function T(o,s){1&o&&e.EFF(0),2&o&&e.SpI(" \xa0 ",s.item.name," ")}function I(o,s){1&o&&e.EFF(0),2&o&&e.SpI(" ",s.item.ip," ")}function V(o,s){1&o&&e.EFF(0),2&o&&e.SpI(" ",s.item.mac," ")}function S(o,s){if(1&o){const t=e.RV6();e.j41(0,"gui-grid",23),e.bIt("selectedRows",function(i){e.eBV(t);const r=e.XpG();return e.Njj(r.onSelectedRowsNewMembers(i))}),e.j41(1,"gui-grid-column",48),e.DNE(2,T,1,1,"ng-template"),e.k0s(),e.j41(3,"gui-grid-column",25),e.DNE(4,I,1,1,"ng-template"),e.k0s(),e.j41(5,"gui-grid-column",49),e.DNE(6,V,1,1,"ng-template"),e.k0s()()}if(2&o){const t=e.XpG();e.Y8G("autoResizeWidth",!0)("searching",t.searching)("source",t.availbleMembers)("columnMenu",t.columnMenu)("sorting",t.sorting)("infoPanel",t.infoPanel)("rowSelection",t.rowSelection)("autoResizeWidth",!0)("paging",t.paging)}}function y(o,s){if(1&o){const t=e.RV6();e.j41(0,"button",9),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.add_new_members())}),e.EFF(1),e.k0s()}if(2&o){const t=e.XpG();e.R7$(),e.SpI("Add ",t.NewMemberRows.length,"")}}function B(o,s){if(1&o&&(e.qex(0),e.j41(1,"span"),e.EFF(2," Are you sure that you want to delete "),e.j41(3,"b",50),e.EFF(4),e.k0s(),e.EFF(5,"? "),e.k0s(),e.nrm(6,"br"),e.j41(7,"p",51),e.EFF(8," All Related Configuration will be deleted/Modified :"),e.nrm(9,"br"),e.EFF(10," * User Permision Related to this group"),e.nrm(11,"br"),e.EFF(12," * Tasks including this Group"),e.nrm(13,"br"),e.k0s(),e.bVm()),2&o){const t=e.XpG();e.R7$(4),e.JRh(t.currentGroup.name)}}const z=[{path:"",component:(()=>{class o{constructor(t,n,i){this.data_provider=t,this.router=n,this.login_checker=i,this.source=[],this.columns=[],this.loading=!0,this.MemberRows=[],this.NewMemberRows=[],this.ConfirmModalVisible=!1,this.ConfirmAction="delete",this.EditGroupModalVisible=!1,this.NewMemberModalVisible=!1,this.groupMembers=[],this.availbleMembers=[],this.currentGroup={array_agg:[],created:"",id:0,name:""},this.DefaultCurrentGroup={array_agg:[],created:"",id:0,name:""},this.sorting={enabled:!0,multiSorting:!0},this.searching={enabled:!0,placeholder:"Search Devices"},this.paging={enabled:!0,page:1,pageSize:10,pageSizes:[5,10,25,50],display:m.sE.ADVANCED},this.columnMenu={enabled:!0,sort:!0,columnsManager:!0},this.infoPanel={enabled:!0,infoDialog:!1,columnsManager:!0,schemaManager:!0},this.rowSelection={enabled:!0,type:m.AU.CHECKBOX,mode:m.fL.MULTIPLE};var r=this;this.login_checker.isLoggedIn()||setTimeout(function(){r.router.navigate(["login"])},100),this.data_provider.getSessionInfo().then(a=>{r.uid=a.uid,r.uname=a.name,"admin"!=a.role&&setTimeout(function(){r.router.navigate(["/user/dashboard"])},100)})}ngOnInit(){this.initGridTable()}show_members(t){this.router.navigate(["devices",{id:t}])}show_delete_group(t){this.currentGroup=t,this.ConfirmModalVisible=!0,this.ConfirmAction="delete"}delete_group(){var t=this;this.data_provider.delete_group(this.currentGroup.id).then(n=>{t.initGridTable(),t.ConfirmModalVisible=!1})}onSelectedRowsMembers(t){this.MemberRows=t,this.SelectedMemberRows=t.map(n=>n.source.id)}onSelectedRowsNewMembers(t){this.NewMemberRows=t,this.SelectedNewMemberRows=t.map(n=>n.source.id)}add_new_members(){this.currentGroup.array_agg=[...new Set(this.currentGroup.array_agg.concat(this.SelectedNewMemberRows))],this.groupMembers=[...new Set(this.groupMembers.concat(this.NewMemberRows.map(n=>n.source)))],this.NewMemberModalVisible=!1}remove_from_group(t){this.currentGroup.array_agg=this.currentGroup.array_agg.filter(i=>i!=t),this.groupMembers=this.groupMembers.filter(i=>i.id!=t)}save_group(){var t=this;this.data_provider.update_save_group(this.currentGroup).then(n=>{t.initGridTable(),t.EditGroupModalVisible=!1})}editAddGroup(t,n){var i=this;if("showadd"==n)return this.currentGroup={...this.DefaultCurrentGroup},this.groupMembers=[],void(this.EditGroupModalVisible=!0);this.currentGroup=t,this.groupMembers=[],this.data_provider.get_devgroup_members(t.id).then(r=>{i.groupMembers=r,i.currentGroup={...t},i.currentGroup.array_agg=t.array_agg.filter(u=>null!=u),i.EditGroupModalVisible=!0})}show_new_member_form(){this.NewMemberModalVisible=!0;var t=this;t.availbleMembers=[],this.SelectedNewMemberRows=[],this.NewMemberRows=[],t.data_provider.get_dev_list({group_id:!1,search:!1,page:!1,size:1e4}).then(i=>{t.availbleMembers=i.filter(r=>!t.currentGroup.array_agg.includes(r.id)),t.NewMemberModalVisible=!0})}logger(t){console.dir(t)}initGridTable(){this.data_provider.get_devgroup_list().then(t=>{this.source=t,this.loading=!1})}static#e=this.\u0275fac=function(n){return new(n||o)(e.rXU(b.C),e.rXU(p.Ix),e.rXU(f.T))};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["ng-component"]],decls:82,vars:29,consts:[["EditGroupModal",""],["NewMemberModal",""],["ConfirmModal",""],["Default",""],["NotDefault",""],["xs",""],[1,"mb-4"],["xs","",3,"lg"],["xs","",2,"text-align","right",3,"lg"],["cButton","","color","primary",3,"click"],[1,"fa-solid","fa-plus"],[3,"source","columnMenu","sorting","infoPanel","autoResizeWidth"],["header","Name","field","name"],["header","Devices","field","array_agg","align","CENTER"],["header","Create Time","field","created"],["header","Actions","field","action"],["backdrop","static","size","lg","id","EditGroupModal",3,"visibleChange","visible"],["cModalTitle",""],["cButtonClose","",3,"cModalToggle"],[1,"mb-3"],[1,"mb-3",3,"cFormFloating"],["cFormControl","","id","floatingInput","placeholder","Group Name",3,"ngModelChange","ngModel"],["cLabel","","for","floatingInput"],[3,"selectedRows","autoResizeWidth","searching","source","columnMenu","sorting","infoPanel","rowSelection","paging"],["header","Member Name","field","name"],["header","perm Name","field","ip"],["header","Actions","width","120","field","action"],["style","margin: 10px 0;","cButton","","color","danger","size","sm",4,"ngIf"],["cButton","","color","secondary",3,"cModalToggle"],["backdrop","static","size","lg","id","NewMemberModal",3,"visibleChange","visible"],["cButtonClose","",3,"click"],[3,"autoResizeWidth","searching","source","columnMenu","sorting","infoPanel","rowSelection","paging","selectedRows",4,"ngIf"],["cButton","","color","primary",3,"click",4,"ngIf"],["cButton","","color","secondary",3,"click"],["backdrop","static","id","ConfirmModal",3,"visibleChange","visible"],[4,"ngIf"],["cButton","","color","danger",3,"click"],[4,"ngIf","ngIfThen","ngIfElse"],["color","info"],["color","info",4,"ngIf"],["cButton","","color","warning","size","sm",1,"mx-1",3,"click","disabled"],[1,"fa-regular","fa-pen-to-square"],["cButton","","color","info","size","sm",1,"mx-1",3,"click","disabled"],[1,"fa-regular","fa-eye"],["cButton","","color","danger","size","sm",1,"mx-1",3,"click","disabled"],[1,"fa-regular","fa-trash-can"],["cButton","","color","danger","size","sm",3,"click"],["cButton","","color","danger","size","sm",2,"margin","10px 0"],["header","Group Name","field","name"],["header","perm Name","field","mac"],[1,"text-danger-emphasis"],[1,"text-danger"]],template:function(n,i){if(1&n){const r=e.RV6();e.j41(0,"c-row")(1,"c-col",5)(2,"c-card",6)(3,"c-card-header")(4,"c-row")(5,"c-col",7),e.EFF(6," Device Groups "),e.k0s(),e.j41(7,"c-col",8)(8,"button",9),e.bIt("click",function(){return e.eBV(r),e.Njj(i.editAddGroup({},"showadd"))}),e.nrm(9,"i",10),e.k0s()()()(),e.j41(10,"c-card-body")(11,"gui-grid",11)(12,"gui-grid-column",12),e.DNE(13,h,1,1,"ng-template"),e.k0s(),e.j41(14,"gui-grid-column",13),e.DNE(15,k,5,3,"ng-template"),e.k0s(),e.j41(16,"gui-grid-column",14),e.DNE(17,D,1,1,"ng-template"),e.k0s(),e.j41(18,"gui-grid-column",15),e.DNE(19,w,6,3,"ng-template"),e.k0s()()()()()(),e.j41(20,"c-modal",16,0),e.mxI("visibleChange",function(a){return e.eBV(r),e.DH7(i.EditGroupModalVisible,a)||(i.EditGroupModalVisible=a),e.Njj(a)}),e.j41(22,"c-modal-header")(23,"h5",17),e.EFF(24," Group Edit"),e.k0s(),e.nrm(25,"button",18),e.k0s(),e.j41(26,"c-modal-body")(27,"c-input-group",19)(28,"div",20)(29,"input",21),e.mxI("ngModelChange",function(a){return e.eBV(r),e.DH7(i.currentGroup.name,a)||(i.currentGroup.name=a),e.Njj(a)}),e.k0s(),e.j41(30,"label",22),e.EFF(31,"Group Name"),e.k0s()()(),e.j41(32,"c-input-group",19)(33,"h5"),e.EFF(34,"Group Members :"),e.k0s(),e.j41(35,"gui-grid",23),e.bIt("selectedRows",function(a){return e.eBV(r),e.Njj(i.onSelectedRowsMembers(a))}),e.j41(36,"gui-grid-column",24),e.DNE(37,N,1,1,"ng-template"),e.k0s(),e.j41(38,"gui-grid-column",25),e.DNE(39,R,1,1,"ng-template"),e.k0s(),e.j41(40,"gui-grid-column",26),e.DNE(41,F,2,0,"ng-template"),e.k0s()(),e.nrm(42,"br"),e.DNE(43,E,3,1,"button",27),e.k0s(),e.nrm(44,"hr"),e.j41(45,"button",9),e.bIt("click",function(){return e.eBV(r),e.Njj(i.show_new_member_form())}),e.EFF(46,"+ Add new Members"),e.k0s()(),e.j41(47,"c-modal-footer")(48,"button",9),e.bIt("click",function(){return e.eBV(r),e.Njj(i.save_group())}),e.EFF(49,"save"),e.k0s(),e.j41(50,"button",28),e.EFF(51," Close "),e.k0s()()(),e.j41(52,"c-modal",29,1),e.mxI("visibleChange",function(a){return e.eBV(r),e.DH7(i.NewMemberModalVisible,a)||(i.NewMemberModalVisible=a),e.Njj(a)}),e.j41(54,"c-modal-header")(55,"h5",17),e.EFF(56,"Members not in Group"),e.k0s(),e.j41(57,"button",30),e.bIt("click",function(){return e.eBV(r),e.Njj(i.NewMemberModalVisible=!i.NewMemberModalVisible)}),e.k0s()(),e.j41(58,"c-modal-body")(59,"c-input-group",19)(60,"h5"),e.EFF(61,"Members Availble to add:"),e.k0s(),e.DNE(62,S,7,9,"gui-grid",31),e.nrm(63,"br"),e.k0s(),e.nrm(64,"hr"),e.k0s(),e.j41(65,"c-modal-footer"),e.DNE(66,y,2,1,"button",32),e.j41(67,"button",33),e.bIt("click",function(){return e.eBV(r),e.Njj(i.NewMemberModalVisible=!i.NewMemberModalVisible)}),e.EFF(68," Close "),e.k0s()()(),e.j41(69,"c-modal",34,2),e.mxI("visibleChange",function(a){return e.eBV(r),e.DH7(i.ConfirmModalVisible,a)||(i.ConfirmModalVisible=a),e.Njj(a)}),e.j41(71,"c-modal-header")(72,"h5",17),e.EFF(73," Are You Sure?"),e.k0s(),e.nrm(74,"button",18),e.k0s(),e.j41(75,"c-modal-body"),e.DNE(76,B,14,1,"ng-container",35),e.k0s(),e.j41(77,"c-modal-footer")(78,"button",36),e.bIt("click",function(){return e.eBV(r),e.Njj(i.delete_group())}),e.EFF(79,"Confirm"),e.k0s(),e.j41(80,"button",28),e.EFF(81," Close "),e.k0s()()()}if(2&n){const r=e.sdS(21),u=e.sdS(70);e.R7$(5),e.Y8G("lg",10),e.R7$(2),e.Y8G("lg",2),e.R7$(4),e.Y8G("source",i.source)("columnMenu",i.columnMenu)("sorting",i.sorting)("infoPanel",i.infoPanel)("autoResizeWidth",!0),e.R7$(9),e.R50("visible",i.EditGroupModalVisible),e.R7$(5),e.Y8G("cModalToggle",r.id),e.R7$(3),e.Y8G("cFormFloating",!0),e.R7$(),e.R50("ngModel",i.currentGroup.name),e.R7$(6),e.Y8G("autoResizeWidth",!0)("searching",i.searching)("source",i.groupMembers)("columnMenu",i.columnMenu)("sorting",i.sorting)("infoPanel",i.infoPanel)("rowSelection",i.rowSelection)("autoResizeWidth",!0)("paging",i.paging),e.R7$(8),e.Y8G("ngIf",0!=i.MemberRows.length),e.R7$(7),e.Y8G("cModalToggle",r.id),e.R7$(2),e.R50("visible",i.NewMemberModalVisible),e.R7$(10),e.Y8G("ngIf",i.NewMemberModalVisible),e.R7$(4),e.Y8G("ngIf",0!=i.NewMemberRows.length),e.R7$(3),e.R50("visible",i.ConfirmModalVisible),e.R7$(5),e.Y8G("cModalToggle",u.id),e.R7$(2),e.Y8G("ngIf","delete"==i.ConfirmAction),e.R7$(4),e.Y8G("cModalToggle",u.id)}},dependencies:[l.iby,l.qHy,l.lMi,_.bT,l.gLf,l.oMR,d.me,d.BC,d.vS,l.l_X,l.e$m,l.YJZ,l.fvw,l._fv,l.UjT,m.V1,m.fz,l.Jyz,l.zfW,l.s$3,l.epl,l.L$K,l.VtU,l.nSt],encapsulation:2})}return o})(),data:{title:$localize`Device Group`}}];let Y=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.$C({type:o});static#o=this.\u0275inj=e.G2t({imports:[p.iI.forChild(z),p.iI]})}return o})(),$=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.$C({type:o});static#o=this.\u0275inj=e.G2t({imports:[Y,l.Dw2,_.MD,l.pc9,d.YN,l.tHK,l.tmq,l.ayw,m.uM,l.G95,l.Q_q,l.EJq]})}return o})()}}]);